<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<meta name="theme-color" content="#075E54"/>
<title>Need Analyzer</title>
<style>
  :root{--wa:#075E54;--wa2:#128C7E;--bg:#e5ddd5;--card:#fff;--btn1:#25D366;--btn2:#128C7E;--muted:#667781;}
  *{box-sizing:border-box}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);}
  .header{position:fixed;top:0;left:0;right:0;z-index:9;background:var(--wa);color:#fff;padding:18px 18px;font-weight:900;font-size:22px;letter-spacing:.2px;}
  .wrap{padding-top:78px;max-width:820px;margin:0 auto;min-height:100vh;}
  .bubble{margin:14px 14px 10px;padding:14px 16px;background:var(--card);border-radius:18px;font-size:16px;line-height:1.35;}
  .row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin:12px 14px 18px;}
  .btn{border:none;cursor:pointer;padding:14px 18px;border-radius:999px;font-weight:900;font-size:16px;color:#fff;background:linear-gradient(90deg,var(--btn1),var(--btn2));}
  .card{margin:14px;padding:14px 16px;background:#fff;border-radius:18px;}
  select{width:100%;padding:12px 12px;border-radius:14px;border:1px solid #d1d7db;background:#fff;font:inherit}
  .chips{display:flex;gap:10px;flex-wrap:wrap;margin-top:10px}
  .chip{padding:10px 14px;border-radius:999px;border:1px solid #d1d7db;background:#fff;font-weight:800;cursor:pointer}
  .chip.sel{background:#dcf8c6;border-color:#cdeabc}
  .muted{color:var(--muted);font-size:13.5px;line-height:1.35}
  .title{font-weight:900;font-size:18px;margin:0 0 6px}
</style>
</head>
<body>
  <div class="header">Need Analyzer</div>
  <div class="wrap" id="app"></div>

<script>
(function(){
  const app = document.getElementById('app');

  const OPTIONS = {
    outflow: ["< 40k","40k – 1 lakh","1 – 1.5 lakhs","1.5 lakhs +","Prefer not to say"],
    wealth: ["< 10L","10L – 50L","50L – 1Cr","1Cr – 3Cr","3Cr+","Prefer not to say"],
    personality: ["Live for today","Live long"],
    colors: ["Black","Red","White","Blue"]
  };

  const goals = [
    ["child_edu","Child education"],
    ["child_wedding","Child wedding"],
    ["home_upgrade","Home upgrade"],
    ["retirement","Retirement lifestyle"],
    ["medical_parent","Medical/parent care"],
    ["business","Business / entrepreneurship"]
  ];

  const a = { outflow:null, wealth:null, personality:null, color:null, goals:{} };
  let gi = 0;

  function bubble(html){
    const b = document.createElement('div');
    b.className = 'bubble';
    b.innerHTML = html;
    app.appendChild(b);
    window.scrollTo(0, document.body.scrollHeight);
    return b;
  }

  function selectQ(q, options, onDone){
    bubble(q);
    const c = document.createElement('div');
    c.className = 'card';
    const s = document.createElement('select');
    s.innerHTML = '<option value="">Select…</option>' + options.map(x=>'<option>'+x+'</option>').join('');
    c.appendChild(s);
    const r = document.createElement('div'); r.className='row';
    const btn = document.createElement('button'); btn.className='btn'; btn.textContent='Continue'; btn.disabled=true;
    r.appendChild(btn);
    c.appendChild(r);
    app.appendChild(c);
    s.onchange = ()=> btn.disabled = !s.value;
    btn.onclick = ()=> onDone(s.value);
    window.scrollTo(0, document.body.scrollHeight);
  }

  function yesNoQ(label, onDone){
    bubble(label);
    const c = document.createElement('div');
    c.className = 'card';
    const chips = document.createElement('div'); chips.className='chips';
    const y = document.createElement('div'); y.className='chip'; y.textContent='Yes';
    const n = document.createElement('div'); n.className='chip'; n.textContent='No';
    chips.appendChild(y); chips.appendChild(n);
    c.appendChild(chips);
    app.appendChild(c);

    function pick(v){
      y.classList.toggle('sel', v==='Yes');
      n.classList.toggle('sel', v==='No');
      onDone(v);
    }
    y.onclick=()=>pick('Yes');
    n.onclick=()=>pick('No');
    window.scrollTo(0, document.body.scrollHeight);
  }

  function score(){
    let protection=0, wealthBuild=0, goalBased=0;

    const outflowScore = {"< 40k":1,"40k – 1 lakh":2,"1 – 1.5 lakhs":3,"1.5 lakhs +":4,"Prefer not to say":2}[a.outflow]||2;
    const wealthTier   = {"< 10L":1,"10L – 50L":2,"50L – 1Cr":3,"1Cr – 3Cr":4,"3Cr+":5,"Prefer not to say":3}[a.wealth]||3;

    protection += outflowScore*2;
    wealthBuild += Math.max(0, wealthTier-1);
    goalBased  += Math.max(0, wealthTier-2);

    if(a.personality==="Live for today"){ protection += 1; wealthBuild += 1; }
    else { goalBased += 2; wealthBuild += 1; }

    const yesCount = Object.values(a.goals).filter(v=>v==="Yes").length;
    goalBased += yesCount*2;

    if(a.color==="Red") wealthBuild += 1;
    if(a.color==="Black") protection += 1;
    if(a.color==="Blue") goalBased += 1;

    const buckets = [
      {name:"Complete lifestyle support", product:"Digit Glow Plus", note:"Complete coverage of mortality + morbidity.", s:protection},
      {name:"Long term corpus building", product:"ULIP", note:"Long-term corpus building with riders.", s:wealthBuild},
      {name:"Pure goal based in long term", product:"Digit ICON", note:"Goal-aligned long-term approach.", s:goalBased}
    ].sort((x,y)=>y.s-x.s);

    bubble("<b>Top-3 Recommendation</b>");
    buckets.forEach((b,i)=>{
      const card = document.createElement('div');
      card.className='card';
      card.innerHTML = '<div class="title">#'+(i+1)+' — '+b.name+'</div>'
        + '<div class="muted"><b>Product:</b> '+b.product+'<br/>'+b.note+'</div>';
      app.appendChild(card);
    });
    window.scrollTo(0, document.body.scrollHeight);
  }

  bubble("<b>Let’s Analyze Your Need!!</b><br><span class='muted'>Answer using ranges — no exact numbers needed.</span>");
  const start = document.createElement('div');
  start.className='row';
  start.innerHTML = '<button class="btn" id="go">Yes Let’s Begin!!</button>';
  app.appendChild(start);

  document.getElementById('go').onclick = ()=>{
    selectQ("1) Monthly outflow for a family like yours?", OPTIONS.outflow, v=>{
      a.outflow=v;
      selectQ("2) Roughly, how much wealth does a family like yours have?", OPTIONS.wealth, v2=>{
        a.wealth=v2;
        selectQ("3) Which feels more like you?", OPTIONS.personality, v3=>{
          a.personality=v3;
          bubble("4) Any planned major expense in the next ~20 years? (Yes/No)");
          const askGoal = ()=>{
            const g = goals[gi];
            yesNoQ("Goal: "+g[1]+" — Planned?", yn=>{
              a.goals[g[0]] = yn;
              gi++;
              if(gi<goals.length) askGoal();
              else selectQ("5) Which car colour do you like most?", OPTIONS.colors, v5=>{
                a.color=v5;
                score();
              });
            });
          };
          askGoal();
        });
      });
    });
  };
})();
</script>
</body>
</html>
